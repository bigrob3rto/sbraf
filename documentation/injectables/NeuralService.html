<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>@coreui/coreui-free-angular-admin-template documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">@coreui/coreui-free-angular-admin-template documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">







<ol class="breadcrumb">
  <li>Injectables</li>
  <li>NeuralService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/service/neural.service.ts</code>
        </p>




            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#model">model</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#normalizationData">normalizationData</a>
                            </li>
                            <li>
                                <a href="#title">title</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#trainData">trainData</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#convertToTensor">convertToTensor</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#createModel">createModel</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#getData">getData</a>
                            </li>
                            <li>
                                <a href="#hide">hide</a>
                            </li>
                            <li>
                                <a href="#predict">predict</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#run">run</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#testModel">testModel</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#trainModel">trainModel</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor()</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="18" class="link-to-prism">src/app/service/neural.service.ts:18</a></div>
                            </td>
                        </tr>

            </tbody>
        </table>
</section>

            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="convertToTensor"></a>
                    <span class="name">
                        <b>
                            convertToTensor
                        </b>
                        <a href="#convertToTensor"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>convertToTensor(data)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="45"
                            class="link-to-prism">src/app/service/neural.service.ts:45</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Convert the input data to tensors that we can use for machine 
learning. We will also do the important best practices of <em>shuffling</em>
the data and <em>normalizing</em> the data
MPG on the y-axis.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>data</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="createModel"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            createModel
                        </b>
                        <a href="#createModel"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>createModel()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="23"
                            class="link-to-prism">src/app/service/neural.service.ts:23</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getData"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Async</span>
                            getData
                        </b>
                        <a href="#getData"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getData()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="90"
                            class="link-to-prism">src/app/service/neural.service.ts:90</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Get the car data reduced to just the variables we are interested
and cleaned of missing data.</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>    <code>{}</code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="hide"></a>
                    <span class="name">
                        <b>
                            hide
                        </b>
                        <a href="#hide"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>hide()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="341"
                            class="link-to-prism">src/app/service/neural.service.ts:341</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="predict"></a>
                    <span class="name">
                        <b>
                            predict
                        </b>
                        <a href="#predict"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>predict(inputs)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="314"
                            class="link-to-prism">src/app/service/neural.service.ts:314</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><hr>
<p>Single point prediction</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>inputs</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="run"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Async</span>
                            run
                        </b>
                        <a href="#run"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>run()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="106"
                            class="link-to-prism">src/app/service/neural.service.ts:106</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><hr>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="testModel"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            testModel
                        </b>
                        <a href="#testModel"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>testModel(model, inputData, normalizationData)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="213"
                            class="link-to-prism">src/app/service/neural.service.ts:213</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>model</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>inputData</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>normalizationData</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="trainModel"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                            trainModel
                        </b>
                        <a href="#trainModel"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>trainModel(model, inputs, labels)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="186"
                            class="link-to-prism">src/app/service/neural.service.ts:186</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>model</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>inputs</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>labels</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>    <code>{}</code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section>
    
        <h3 id="inputs">
            Properties
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="model"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            model</b>
                            <a href="#model"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="17" class="link-to-prism">src/app/service/neural.service.ts:17</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="normalizationData"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            normalizationData</b>
                            <a href="#normalizationData"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="18" class="link-to-prism">src/app/service/neural.service.ts:18</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="title"></a>
                        <span class="name">
                            <b>
                            title</b>
                            <a href="#title"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>&#x27;nn&#x27;</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="15" class="link-to-prism">src/app/service/neural.service.ts:15</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="trainData"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            trainData</b>
                            <a href="#trainData"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>[]</code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>[]</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="16" class="link-to-prism">src/app/service/neural.service.ts:16</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable, OnInit } from &#x27;@angular/core&#x27;;

// tensorflow import
import * as tf from &#x27;@tensorflow/tfjs&#x27;;
import * as tfvis from &#x27;@tensorflow/tfjs-vis&#x27;;

// var tf;
// var tfvis;

@Injectable({
  providedIn: &#x27;root&#x27;
})

export class NeuralService  {
  title &#x3D; &#x27;nn&#x27;;
  public trainData &#x3D; [];
  public model;
  public normalizationData;


  constructor() { }

  private createModel() {
    // Create a sequential model
    const model &#x3D; tf.sequential();

    // Add a single input layer
    model.add(tf.layers.dense({ inputShape: [3], units: 3, useBias: true }));
    // hidden layer
    model.add(tf.layers.dense({ units: 50, activation: &#x27;relu&#x27; }));
    // model.add(tf.layers.dense({ units: 5, activation: &#x27;relu&#x27; }));

    // Add an output layer
    model.add(tf.layers.dense({ units: 1, useBias: true }));

    return model;
  }

  /**
   * Convert the input data to tensors that we can use for machine 
   * learning. We will also do the important best practices of _shuffling_
   * the data and _normalizing_ the data
   * MPG on the y-axis.
   */
  convertToTensor(data) {
    // Wrapping these calculations in a tidy will dispose any 
    // intermediate tensors.

    return tf.tidy(() &#x3D;&gt; {
      // Step 1. Shuffle the data    
      tf.util.shuffle(data);

      // Step 2. Convert data to Tensor
      // const inputs &#x3D; data.map(d &#x3D;&gt; d.wei);
      const inputs &#x3D; data.map(d &#x3D;&gt; [d.price, d.weekday, d.foodcost]);
      const labels &#x3D; data.map(d &#x3D;&gt; d.revenue);

      const inputTensor &#x3D; tf.tensor2d(inputs, [inputs.length, 3]);
      const labelTensor &#x3D; tf.tensor2d(labels, [labels.length, 1]);

      //Step 3. Normalize the data to the range 0 - 1 using min-max scaling
      const inputMax &#x3D; inputTensor.max(0);  // get max on axes 0
      // tf.print(inputMax);
      const inputMin &#x3D; inputTensor.min(0);  // get max on axes 0
      // tf.print(inputMin);
      const labelMax &#x3D; labelTensor.max();
      const labelMin &#x3D; labelTensor.min();

      const normalizedInputs &#x3D; inputTensor.sub(inputMin).div(inputMax.sub(inputMin));
      const normalizedLabels &#x3D; labelTensor.sub(labelMin).div(labelMax.sub(labelMin));

      this.normalizationData &#x3D; {
        inputs: normalizedInputs,
        labels: normalizedLabels,
        // Return the min/max bounds so we can use them later.
        inputMax,
        inputMin,
        labelMax,
        labelMin,
      }
      
      return this.normalizationData;
    });
  }

  /**
 * Get the car data reduced to just the variables we are interested
 * and cleaned of missing data.
 */
  async getData() {
    // const carsDataResponse &#x3D; await fetch(&#x27;https://storage.googleapis.com/tfjs-tutorials/carsData.json&#x27;);
    // const carsData &#x3D; await carsDataResponse.json();
    // const cleaned &#x3D; carsData.map(car &#x3D;&gt; ({
    //   mpg: car.Miles_per_Gallon,
    //   wei: car.Weight_in_lbs,
    //   horsepower: car.Horsepower,
    // }))
    //   .filter(car &#x3D;&gt; (car.mpg !&#x3D; null &amp;&amp; car.horsepower !&#x3D; null &amp;&amp; car.wei !&#x3D; null));

    const cleaned &#x3D; this.trainData.filter(row &#x3D;&gt; (row.price !&#x3D; null &amp;&amp; row.weekday !&#x3D; null
      &amp;&amp; row.revenue !&#x3D; null &amp;&amp; row.foodcost !&#x3D; null));
    return cleaned;
  }

  /***************************************************** */
  async run() {
    // create visor
    // const c1 &#x3D; document.parentElement //getElementById(&quot;model&quot;);
    // Create a surface and specify its height
    tfvis.visor();

    // Load and plot the original input data that we are going to train on.
    const data &#x3D; await this.getData();
    const v1 &#x3D; data.map(d &#x3D;&gt; ({
      x: d.price,
      y: d.revenue,
    }));

    let surface &#x3D; { name: &#x27;Revenue vs Price&#x27;, tab: &#x27;Data&#x27; };

    tfvis.render.scatterplot(
      surface,
      { values: v1 },
      {
        xLabel: &#x27;Price&#x27;,
        yLabel: &#x27;Revenue&#x27;,
        height: 220
      }
    );
    tfvis.visor().setActiveTab(&#x27;Data&#x27;);

    const v2 &#x3D; data.map(d &#x3D;&gt; ({
      x: d.weekday,
      y: d.revenue,
    }));

    surface &#x3D; { name: &#x27;Revenue vs Weekday&#x27;, tab: &#x27;Data&#x27; };
    tfvis.render.scatterplot(
      surface,
      { values: v2 },
      {
        xLabel: &#x27;Weekday&#x27;,
        yLabel: &#x27;Revenue&#x27;,
        height: 220
      }
    );

    const v3 &#x3D; data.map(d &#x3D;&gt; ({
      x: d.foodcost,
      y: d.revenue,
    }));

    surface &#x3D; { name: &#x27;Revenue vs Foodcost&#x27;, tab: &#x27;Data&#x27; };
    tfvis.render.scatterplot(
      surface,
      { values: v3 },
      {
        xLabel: &#x27;Foodcost&#x27;,
        yLabel: &#x27;Revenue&#x27;,
        height: 220
      }
    );

    // More code will be added below
    // Create the model
    this.model &#x3D; this.createModel();
    // const c1 &#x3D; document.getElementById(&quot;model&quot;);
    const surface1 &#x3D; { name: &#x27;Model Summary&#x27;, tab: &#x27;Model&#x27; };
    tfvis.show.modelSummary(surface1, this.model);
    // tfvis.visor().setActiveTab(&#x27;Model&#x27;);

    // Convert the data to a form we can use for training.
    const tensorData &#x3D; this.convertToTensor(data);
    const { inputs, labels } &#x3D; tensorData;

    // Train the model  
    await this.trainModel(this.model, inputs, labels);
    // console.log(&#x27;Done Training&#x27;);

    // Make some predictions using the model and compare them to the
    // original data
    this.testModel(this.model, data, tensorData);
  }


  public async trainModel(model, inputs, labels) {
    // Prepare the model for training.  
    model.compile({
      optimizer: tf.train.adam(),
      loss: tf.losses.meanSquaredError,
      metrics: [&#x27;mse&#x27;],
    });

    const batchSize &#x3D; 128;
    const epochs &#x3D; 50;

    // tf.print( inputs);
    const surface &#x3D; { name: &#x27;Training&#x27;, tab: &#x27;Training&#x27; };
    // tfvis.visor().setActiveTab(&#x27;Training&#x27;);

    return await model.fit(inputs, labels, {
      batchSize,
      epochs,
      shuffle: true,
      callbacks: tfvis.show.fitCallbacks(
        surface,
        [&#x27;loss&#x27;, &#x27;mse&#x27;],
        { height: 220, callbacks: [&#x27;onEpochEnd&#x27;] }
      )
    });
  }

  public testModel(model, inputData, normalizationData) {
    const { inputMax, inputMin, labelMin, labelMax } &#x3D; normalizationData;

    // Generate predictions for a uniform range of numbers between 0 and 1;
    // We un-normalize the data by doing the inverse of the min-max scaling 
    // that we did earlier.
    const [xs, preds] &#x3D; tf.tidy(() &#x3D;&gt; {

      const x1 &#x3D; tf.linspace(0, 1, 100);
      const x2 &#x3D; tf.linspace(0, 1, 100);
      const x3 &#x3D; tf.linspace(0, 1, 100);
      const xs &#x3D; x1.concat(x2).concat(x3).reshape([100, 3]);
      // console.log(&quot;Test data&quot;)
      // tf.print(testData);
      // const preds &#x3D; model.predict(xs.reshape([100, 2]));

      // const xs &#x3D; testData
      const preds &#x3D; model.predict(xs);

      const unNormXs &#x3D; xs
        .mul(inputMax.sub(inputMin))
        .add(inputMin);

      const unNormPreds &#x3D; preds
        .mul(labelMax.sub(labelMin))
        .add(labelMin);

      // Un-normalize the data
      return [&lt;any&gt;unNormXs.arraySync(), &lt;any&gt;unNormPreds.dataSync()];
    });


    let predictedPoints &#x3D; xs
      .map((val, i) &#x3D;&gt; {
        return { x: val[1], y: preds[i] }
      });

    let originalPoints &#x3D; inputData.map(d &#x3D;&gt; ({
      x: d.weekday, y: d.revenue,
    }));


    let surface &#x3D; { name: &#x27;Revenue vs Weekday&#x27;, tab: &#x27;Prediction&#x27; };

    tfvis.render.scatterplot(
      surface,
      { values: [originalPoints, predictedPoints], series: [&#x27;original&#x27;, &#x27;predicted&#x27;] },
      {
        xLabel: &#x27;Weekday&#x27;,
        yLabel: &#x27;Revenue&#x27;,
        height: 220
      }
    );

    tfvis.visor().setActiveTab(&#x27;Prediction&#x27;);

    predictedPoints &#x3D; xs
      .map((val, i) &#x3D;&gt; {
        return { x: val[0], y: preds[i] }
      });

    originalPoints &#x3D; inputData.map(d &#x3D;&gt; ({
      x: d.price, y: d.revenue,
    }));

    surface &#x3D; { name: &#x27;Revenue vs Price&#x27;, tab: &#x27;Prediction&#x27; };
    tfvis.render.scatterplot(
      surface,
      { values: [originalPoints, predictedPoints], series: [&#x27;original&#x27;, &#x27;predicted&#x27;] },
      {
        xLabel: &#x27;Price&#x27;,
        yLabel: &#x27;Revenue&#x27;,
        height: 220
      }
    );

    predictedPoints &#x3D; xs
      .map((val, i) &#x3D;&gt; {
        return { x: val[2], y: preds[i] }
      });

    originalPoints &#x3D; inputData.map(d &#x3D;&gt; ({
      x: d.foodcost, y: d.revenue,
    }));

    surface &#x3D; { name: &#x27;Revenue vs Foodcost&#x27;, tab: &#x27;Prediction&#x27; };
    tfvis.render.scatterplot(
      surface,
      { values: [originalPoints, predictedPoints], series: [&#x27;original&#x27;, &#x27;predicted&#x27;] },
      {
        xLabel: &#x27;Foodcost&#x27;,
        yLabel: &#x27;Revenue&#x27;,
        height: 220
      }
    );

  }

  /*********************************************
   * Single point prediction
   */
  predict(inputs) : number {

    const preds &#x3D; tf.tidy(() &#x3D;&gt; {
      const { inputMax, inputMin, labelMin, labelMax } &#x3D; this.normalizationData;

      const inputTensor &#x3D; tf.tensor2d(inputs, [1,inputs.length]);
      const normalizedInputs &#x3D; inputTensor.sub(inputMin).div(inputMax.sub(inputMin));

      const preds &#x3D; this.model.predict(normalizedInputs);

      const unNormXs &#x3D; normalizedInputs
        .mul(inputMax.sub(inputMin))
        .add(inputMin);

      const unNormPreds &#x3D; preds
        .mul(labelMax.sub(labelMin))
        .add(labelMin);

      // Un-normalize the data
      // return [&lt;any&gt;unNormXs.arraySync(), &lt;any&gt;unNormPreds.dataSync()];
      return Number(unNormPreds.dataSync()[0]);
      });

    return preds;
  }


  hide() {
    tfvis.visor().toggle();
  }


}</code></pre>
    </div>

</div>







                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'NeuralService.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
