<div class="animated fadeIn">
    <div class="card-deck">
        <div class="card">
            <app-mcfilter #mcfilter (menuSelect)="onMenuSelect($event)" (categorySelect)="onCategorySelect($event)">
            </app-mcfilter>
        </div>


        <div class="card">
            <div class="card-header">Date range</div>
            <div class="card-body pb-0">
                <app-daterange></app-daterange>
                <!-- <pre class="small"> Cache:     {{cache_start}} - {{cache_stop}}</pre> -->
            </div>
        </div>
        <div class="card">
            <div class="card-header">Load data</div>
            <div class="card-body p-0">
                <div style="text-align: center; vertical-align: middle;"><br>
                    <button class="btn btn-success" (click)="refresh()" [disabled]="loading" data-toggle="tooltip"
                        data-placement="bottom" title="Load remote data">View
                        <i class="fa fa-spinner fa-spin" *ngIf="loading"></i>
                    </button>
                    <button class="btn btn-danger" (click)="stopQuery()" *ngIf="dbd_stopBtn">Cancel</button>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">Aggregation</div>
            <div class="card-body pb-0">
                <div class="btn-group btn-group-toggle mr-3" data-toggle="buttons" *ngIf="radioModel">
                    <label class="btn btn-outline-secondary" [(ngModel)]="radioModel" btnRadio="Day"
                        (ngModelChange)="radioChoose($event)">Day</label>
                    <label class="btn btn-outline-secondary" [(ngModel)]="radioModel" btnRadio="Week"
                        (ngModelChange)="radioChoose($event)">Week</label>
                    <label class="btn btn-outline-secondary" [(ngModel)]="radioModel" btnRadio="Month"
                        (ngModelChange)="radioChoose($event)">Month</label>
                </div>
            </div>
        </div>

    </div>
    <!--/.col-->

    <!-- Confirmation dialog for unsaved data -->
    <div bsModal #myModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Unsaved data</h4>
                    <button type="button" class="close" (click)="myModal.hide()" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p>Unsaved data in your table. Changes will be lost&hellip; <br>Sure to proceed?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" (click)="modalCancel()">Cancel</button>
                    <button type="button" class="btn btn-primary" (click)="modalProceed()">Proceed</button>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->



    <div class=" row">

        <div class="card" style="width: 100%;" id="pdfImg">
            <div class="card-header">

                <i *ngIf="loading" class="fa fa-spinner fa-spin fa-fw"></i>
                <i *ngIf="!loading" class="fa fa-shopping-basket" aria-hidden="true"></i> {{title}}
                <i *ngIf="unsaved" class="fa fa-exclamation-triangle" style="color:orange" aria-hidden="true"></i>
                <app-button [btnPrint]="btnPrint" [print]="print" [btnRefresh]="btnRefresh" [refresh]="refresh"
                    [btnSave]="btnSave" [saveTable]="saveTable" [btnExport]="btnExport" [export]="export"
                    [btnReload]="btnReload" [reload]="reload">
                </app-button>

                <div class="row" *ngIf="pb_current<=100">
                    <div class="progress" style="width: 100%;">
                        <div class="progress-bar" role="progressbar" [style.width]="pb_current + '%'" aria-valuenow="25"
                            aria-valuemin="0" aria-valuemax="100">
                            {{pb_current | number : '1.1-1'}}%</div>
                    </div>
                </div>
            </div>
            <tabset>

                <tab heading="Elasticity Index" [active]="true">
                    <app-elasticity #elasticityComponent></app-elasticity>
                </tab>
                <tab heading="Elasticity by Week" [active]="false">
                    <app-elasticity-week #elasticityWeekComponent></app-elasticity-week>
                </tab>
                <tab hidden>
                    <div class="card-body">
                        <div class="row">
                            <ag-grid-angular #agGridFooter style="width: 100%;" [ngClass]="theme" [rowData]="footerData"
                                [columnDefs]="columnDefs" [animateRows]="true" [paginationAutoPageSize]=false
                                [pagination]="false" [headerHeight]="0" [domLayout]="domLayout"
                                [gridOptions]="bottomOptions" (newColumnsLoaded)="onNewColumnsLoaded($event)"
                                (gridReady)="onGridReady1($event)">
                            </ag-grid-angular>
                        </div>
                        <div class="row">
                            <ag-grid-angular #agGrid style="width: 100%; height: calc(100vh - 240px);" [ngClass]="theme"
                                [rowData]="rowData" [columnDefs]="columnDefs" [animateRows]="true"
                                [paginationAutoPageSize]=false [pagination]="false" [gridOptions]="topOptions"
                                (gridReady)="onGridReady2($event)">
                            </ag-grid-angular>
                        </div>
                    </div>
                </tab>
            </tabset>
        </div>
    </div>