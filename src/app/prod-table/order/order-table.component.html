<div class="animated fadeIn" *ngIf="!isUserLogged()">
    <h1 style="text-align: center;">Please
        <a href="#/login">log in</a> to use this feature.
    </h1>
</div>
<div class="animated fadeIn">
    <div class="card-deck mt-3">
        <div class="card">
            <div class="card-header">Date range</div>
            <div class="card-body">
                <app-daterange></app-daterange>
            </div>
        </div>
        <div class="card">
            <div class="card-header">Load data</div>
            <div class="card-body">
                <div style="text-align: center; vertical-align: middle;"><br>
                    <button class="btn btn-success" (click)="refresh()" [disabled]="loading" data-toggle="tooltip"
                    data-placement="bottom" title="Load remote data">View
                        <i class="fa fa-spinner fa-spin" *ngIf="loading"></i>
                    </button>
                    <button class="btn btn-danger" (click)="stopQuery()" *ngIf="stopBtn">Cancel</button>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
            </div>
        </div>
        <div class="card">
            <div class="card-body">
            </div>
        </div>
    </div>

    <div class="card mt-3" *ngIf="isUserLogged()">
        <div class="card-header">
            <i *ngIf="loading" class="fa fa-spinner fa-spin fa-fw"></i>
            <i *ngIf="!loading" class="fa fa-shopping-basket" aria-hidden="true"></i> {{title}}
            <i *ngIf="unsaved" class="fa fa-exclamation-triangle" style="color:orange" aria-hidden="true"></i>
            <app-button [btnExport]="btnExport" [export]="export" [btnRefresh]="btnRefresh" [refresh]="refresh"
                [btnSave]="btnSave" [saveTable]="saveTable" [btnReload]="btnReload" [reload]="reload">
            </app-button>

            <div class="row" *ngIf="pb_current<=100">
                <div class="progress" style="width: 100%;">
                    <div class="progress-bar" role="progressbar" [style.width]="pb_current + '%'" aria-valuenow="25"
                        aria-valuemin="0" aria-valuemax="100">
                        {{pb_current | number : '1.1-1'}}%</div>
                </div>
            </div>
        </div>
        <!-- Confirmation dialog for unsaved data -->
        <div bsModal #myModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Unsaved data</h4>
                        <button type="button" class="close" (click)="myModal.hide()" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p>Unsaved data in your table. Changes will be lost&hellip; <br>Sure to proceed?</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" (click)="modalCancel()">Cancel</button>
                        <button type="button" class="btn btn-primary" (click)="modalProceed()">Proceed</button>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->

        <div class="card-body">
            <div class="row">
                <input type="text" id="filter-text-box" class="float-left border-1" 
                style="font-size: 12px; outline: 0 none; box-shadow: none; border-color:white;"
                placeholder="Find filter..." (input)="onFilterTextBoxChanged()"/>        
                <!-- <ag-grid-angular #gridRef style="width: 100%; height: calc(100vh - 240px);" [ngClass]="theme"
            [enableSorting]="true" [enableFilter]="true" [localeText]="localeText" [rowData]="rowData"
            [enterMovesDown]="true" [paginationAutoPageSize]=true [rowSelection]="rowSelection" [singleClickEdit]="true"
            [enterMovesDownAfterEdit]="true" (gridReady)="onGridReady($event)" [pagination]="true"
            [gridOptions]="gridOptions"></ag-grid-angular> -->
                <ag-grid-angular #agGrid style="width: 100%; height: calc(100vh - 240px);" [ngClass]="theme"
                    [rowData]="rowData" [columnDefs]="columnDefs" [animateRows]="true" [getRowStyle]="getRowStyle"
                    [rowSelection]="rowSelection" [rowMultiSelectWithClick]="false" [enableCellTextSelection]="false"
                    [defaultColDef]="defaultColDef" [enterMovesDown]="true" [paginationAutoPageSize]="false"
                    [singleClickEdit]="false" [enterMovesDownAfterEdit]="true" [pagination]="true"
                    [getContextMenuItems]="getContextMenuItems" (cellValueChanged)="onCellValueChanged($event)"
                    (gridReady)="onGridReady($event)">
                </ag-grid-angular>
            </div>
        </div>
    </div>
</div>
<!-- 
[rowModelType]="rowModelType"
                    [paginationPageSize]="paginationPageSize" [cacheOverflowSize]="cacheOverflowSize"
                    [maxConcurrentDatasourceRequests]="maxConcurrentDatasourceRequests"
                    [infiniteInitialRowCount]="infiniteInitialRowCount" [maxBlocksInCache]="maxBlocksInCache"
                     -->